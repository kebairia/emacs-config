# ------------------------------------------------------------------------------
#+TITLE:     My Emacs's Configuration
#+SUBTITLE:  Kebairia Zakaria - January 2021
#+AUTHOR:    Kebairia Zakaria
#+EMAIL:     4.kebairia@gmail.com
#+LANGUAGE:  en
#+STARTUP:   content showstars indent inlineimages hideblocks
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="/home/zakaria/org/conf/rouger.css" />
#+OPTIONS:   toc:2 html-scripts:nil num:nil html-postamble:nil html-style:nil ^:nil
#+PROPERTY:  header-args :results none
#+ARCHIVE: ~/org/config_archive.org::
# ------------------------------------------------------------------------------

* BOOTSTRAP
:PROPERTIES:
:header-args: :tangle ~/.config/emacs/init.el
:header-args: :results none
:END:
** Deps
   #+begin_src emacs-lisp
              ;;; package --- Summary  
     ;; Load configuration from ~/.config/emacs/modules/*.el

              ;;; Commentary:
     ;; Added by Package.el.  This must come before configurations of
     ;; installed packages.  Don't delete this line.  If you don't want it,
     ;; just comment it out by adding a semicolon to the start of the line.
     ;; You may delete these explanatory comments.

     ;; Speed up startup
     (setq gc-cons-threshold 402653184
           gc-cons-percentage 0.6)
     (add-hook 'after-init-hook
               `(lambda ()
                  (setq gc-cons-threshold 800000
                        gc-cons-percentage 0.1)
                  (garbage-collect)) t)
     (require 'package)
     (add-to-list 'package-archives '("gnu" . "https://elpa.gnu.org/packages/") t)
     (add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/") t)
     (add-to-list 'package-archives '("org" . "http://orgmode.org/elpa/") t)

     (package-initialize)

     (defconst user-init-dir
       (cond ((boundp 'user-emacs-directory)
              user-emacs-directory)
             ((boundp 'user-init-directory)
              user-init-directory)
             (t "~/.config/emacs")))

     (defun load-user-file (file)
       (interactive "f")
       "Load a file in current user's configuration directory"
       (load-file (expand-file-name file user-init-dir)))

     ;;(load-user-file "DEFAULTS.el")
     (load-user-file "nano/nano.el")
     (load-user-file "nano/nano-base-colors.el")
     (load-user-file "nano/nano-faces.el")
     (load-user-file "nano/nano-theme-dark.el")
     (load-user-file "nano/nano-theme.el")

     ;; (load-user-file "clean-theme/clean.el")
     ;; (load-user-file "clean-theme/defaults.el")
     (load-user-file "modules/KEYBIDING.el")
     (load-user-file "modules/PACKAGES.el")
     (load-user-file "modules/ORG.el")
     ;; Measure emacs startup time
     (add-to-list 'after-init-hook
                  (lambda ()
                    (message (concat "emacs (" (number-to-string (emacs-pid)) ") started in " (emacs-init-time)))))
   #+end_src
** Hist, Backup and auto-save
     check it here: [[https://github.com/bradwright/emacs.d]]
     use ~${HOME}/.cache/emacs~ for undo,backup and history
    #+begin_src emacs-lisp
      ;; Hist, Backup and auto-save ..etc
      ;;---------------------------------
      (setq backup-directory-alist '(("." . "~/.local/share/emacs/backup"))
        backup-by-copying t                       ; Don't delink hardlinks
        version-control t                         ; Use version numbers on backups
        delete-old-versions t                     ; Automatically delete excess backups
        kept-new-versions 3                       ; how many of the newest versions to keep
        kept-old-versions 3                       ; and how many of the old
        vc-make-backup-files t                    ; Even version controlled files get to be backed up.
        )
      (setq auto-save-file-name-transforms
            '((".*" "~/.local/share/emacs/undo/" t)))
      (setq undo-tree-history-directory-alist     ; Saving persistent tree-undo to a single directory
            '(("." . "~/.local/share/emacs/undo")))

      (setq is-work nil)                         ; *--=~~ search for explanations ~~=--*
      ;; t means no truncation
      (setq history-length t)
      (setq history-delete-duplicates t)

      (savehist-mode 1)                           ; Saves your minibuffer histories
      (setq
       savehist-file "~/.local/share/emacs/savehist")    ; Set the savehist file
      (setq savehist-save-minibuffer-history 1)
      (setq savehist-additional-variables         ; Save other histories and other variables as well
            '(kill-ring
              search-ring
              regexp-search-ring))
      ;; (setq auto-save-list-file-prefix       ("~/.local/share/emacs" "sessions/"))
      ;; (setq recentf-save-file                ("~/.local/share/emacs/recentf-save.el"))
     #+end_src
* KEYMAPS
:PROPERTIES:
:header-args: :tangle ~/.config/emacs/modules/KEYBIDING.el
:header-args: :results none
:END:
** Files
   #+begin_src emacs-lisp
     ;; some shortcuts -- files
     (global-set-key (kbd "C-c C") (lambda() (interactive)(find-file "~/.config/emacs/init.org")))
     (global-set-key (kbd "C-c b") (lambda() (interactive)(find-file "~/org/books.org")))
     (global-set-key (kbd "C-c I") (lambda() (interactive)(find-file "~/org/gtd/inbox.org")))
     ;;(global-set-key (kbd "C-c L") (lambda() (interactive)(find-file "~/org/links.org")))
     ;;(global-set-key (kbd "C-c E") (lambda() (interactive)(find-file "~/org/gtd/emails.org")))
     (global-set-key (kbd "<f12>") (lambda() (interactive)(find-file "~/org/files/org.pdf")))
     ;; Reload buffer with <F5>
     (global-set-key [f5] '(lambda () (interactive) (revert-buffer nil t nil)))
   #+end_src

** win-movements
   #+begin_src emacs-lisp
       (defun zk/split-go-right()
         (interactive)
         (split-window-horizontally)
         (windmove-right))
       (defun zk/split-go-down()
         (interactive)
         (split-window-vertically)
         (windmove-down))
        ;; try to go to the other window automaticly
        (global-set-key (kbd "C-x i") 'zk/split-go-right)
        (global-set-key (kbd "C-x m") 'zk/split-go-down)

        ;; Move between buffer
        (global-set-key (kbd "M-n") 'switch-to-next-buffer)
        (global-set-key (kbd "M-p") 'switch-to-prev-buffer)

        ;; Move between Windows
        (global-set-key (kbd "C-x k") 'windmove-up)
        (global-set-key (kbd "C-x j") 'windmove-down)
        (global-set-key (kbd "C-x l") 'windmove-right)
        (global-set-key (kbd "C-x h") 'windmove-left)

        ;; Resize windows
        (global-set-key (kbd "C-M-l") 'shrink-window-horizontally)
        (global-set-key (kbd "C-M-h") 'enlarge-window-horizontally)
        (global-set-key (kbd "C-M-j") 'shrink-window)
        (global-set-key (kbd "C-M-k") 'enlarge-window)

        (global-set-key (kbd "M-o") 'delete-other-windows)
        (global-set-key (kbd "C-x p") 'zk/org-agenda-process-inbox-item)
   #+end_src
* PACKAGES
  :PROPERTIES:
  :header-args: :tangle ~/.config/emacs/modules/PACKAGES.el
  :header-args: :results none
  :END:
** evil mode
#+BEGIN_SRC emacs-lisp
  (setq evil-want-keybinding nil)                   ;; this statement is required to enable evil/evil-colleciton mode
  (evil-mode 1)                                     ;; enable evil-mode
  (setq evil-want-abbrev-expand-on-insert-exit nil)
  (use-package evil-collection                      ;; evil-friendly binding for many modes
    :after evil
    :ensure t
    :config
    (evil-collection-init))

  ;; (use-package evil-magit
  ;;   :after evil)
  (use-package evil-org
    :after org
    :config
    (add-hook 'org-mode-hook 'evil-org-mode)
    (add-hook 'evil-org-mode-hook
              (lambda () (evil-org-set-key-theme)))
    (require 'evil-org-agenda)
    (evil-org-agenda-set-keys))
  (setq                                             ;;automatically use evil for ibuffer and dired
   evil-emacs-state-modes
      (delq 'ibuffer-mode evil-emacs-state-modes))
#+END_SRC
** evil-leader
   #+BEGIN_SRC emacs-lisp
     (use-package evil-leader
     ;; needs to be enabled before M-x evil-mode!
         :ensure t
         :config
             (evil-leader/set-leader ",")
             (evil-leader/set-key
              "a" 'zk/switch-to-agenda
              "w" 'org-agenda-week-view
              "m" 'org-agenda-month-view
              "d" 'deft
              "g" 'magit-status
              ;; "I" 'zetteldeft-insert-list-links
              ;; "N" 'zetteldeft-new-file-and-link
              ;; "B" 'zetteldeft-new-file-and-backlink
              ;; "f" 'pdf-links-action-perform
              ;; "b" 'ibuffer
              ;; "t" 'term
              "c" 'org-capture
              ;; "g" 'magit-status
              "r" 'bookmark-bmenu-list
              "l" 'org-store-link
              "L" 'org-insert-link
              ;; "n" 'org-noter
              "q" 'kill-current-buffer)
             (evil-leader-mode 1)
             (global-evil-leader-mode 1))
              ;;"B" 'zetteldeft-backlink-add
              ;;"s" 'zk/gen-scratch-buffer
   #+END_SRC
** COMMENT Deft
   #+BEGIN_SRC emacs-lisp
     ;; disable linum-mode (line number)
     (add-hook 'deft
     '(lambda () (linum-mode nil)))
      (use-package deft
         :commands (deft)
         :custom       (deft-directory "~/org/notes" )
                       (deft-recursive t)
                       (deft-extensions '("org" "md" "txt") )
                       (deft-use-filename-as-title t)
                       (deft-file-naming-rules
                         '((noslash . "-")
                           (nospace . "-")
                           (case-fn . downcase))
                       deft-org-mode-title-prefix t
                       deft-text-mode 'org-mode))


   #+END_SRC
** COMMENT Zetteldeft
   #+begin_src emacs-lisp
     (use-package zetteldeft
       :ensure t
       :after deft
       :config (zetteldeft-set-classic-keybindings))
   #+end_src
** COMMENT org roam
#+begin_src emacs-lisp
  (use-package org-roam
        :ensure t
        :hook
        (after-init . org-roam-mode)
        :custom
        (org-roam-directory "/home/zakaria/org/notes")
        :bind (:map org-roam-mode-map
                (("C-c n l" . org-roam)
                 ("C-c n f" . org-roam-find-file)
                 ("C-c n g" . org-roam-graph))
                :map org-mode-map
                (("C-c n i" . org-roam-insert))
                (("C-c n I" . org-roam-insert-immediate))))
  (org-roam-mode 1)
#+end_src
** Magit
#+begin_src emacs-lisp
  (use-package magit)
  (use-package evil-magit
    :after magit)
  "Display BUFFER in same-window"
  (custom-set-variables
   '(magit-display-buffer-function 'magit-display-buffer-traditional))
  ;; '(magit-display-buffer-function 'magit-display-buffer-same-window-except-diff-v1))
#+end_src
** Minions
   #+BEGIN_SRC emacs-lisp
     ;;Use minions to hide all minor modes
     (use-package minions
       :config
       (setq minions-mode-line-lighter ""
             minions-mode-line-delimiters '("" . ""))
       (minions-mode 1))
   #+END_SRC
** Ibuffer
   #+BEGIN_SRC emacs-lisp
     ;; disable linum-mode
     (add-hook 'ibuffer-mode (lambda() (linum-mode -1)))
     (global-set-key (kbd "C-x C-b") 'ibuffer) ;; Use Ibuffer for Buffer List
     ;; create a function that define a group
     (setq ibuffer-saved-filter-groups
         '(("default"
            ("Emacs"  (or
                        (name . "^\\*Messages\\*$")
                        (name . "^\\*scratch\\*$")
            ))
            ("Agenda"  (or
                        (name . "inbox.org")
                        (name . "next.org")
                        (name . "someday.org")
                        (name . "emails.org")
                        (name . "archive.org")
                        (name . "habits.org")
                        (name . "projects.org")
                        (name . "weekly_reviews.org")
                ))

            ("Org"  (name . "^.*org$"))
            ("PDF"  (name . "^.*pdf"))
            ("Python"  (name . "^.*py$"))
            ("Elisp"  (name . "^.*el"))
            ("Web"  (or
                        (name . "^.*html$")
                        (name . "^.*css")
                        (name . "^.*php")
                ))
            ("Dired"  (mode . dired-mode))
          ))
       )

     (add-hook 'ibuffer-mode-hook
      '(lambda ()
         (ibuffer-auto-mode 1)
         (ibuffer-switch-to-saved-filter-groups "default"))) ;; use the group default

   #+END_SRC
** UndoTree
   #+BEGIN_SRC emacs-lisp
     ;;turn on everywhere
     (global-undo-tree-mode 1)
     ;; Save history to a file
     (setq
         undo-tree-auto-save-history 1 ; Show relative times in the undo tree visualizer
         undo-tree-visualizer-timestamps 1; Show diffs when browsing through the undo tree
         undo-tree-visualizer-diff 1)
   #+END_SRC

** which-key
    Which-key Package show me a helpful menu when i press "C-x" and wait
#+BEGIN_SRC emacs-lisp
   (use-package which-key
    :ensure t
    :config
    (which-key-mode))
#+END_SRC
** ace-window
#+BEGIN_SRC emacs-lisp
  ;; it looks like counsel is a requirement for swiper
  ;; counsel give us a nice looking interface when we use M-x
  (use-package counsel
    :ensure t)
#+END_SRC
#+BEGIN_SRC emacs-lisp
  (global-set-key (kbd "C-x o") 'ace-window)
#+END_SRC
** TODO Aggressive Indent
The variable aggressive-indent-dont-indent-if lets you customize when you don't want indentation to happen.
#+begin_example
(add-to-list
 'aggressive-indent-dont-indent-if
 '(and (derived-mode-p 'c++-mode)
       (null (string-match "\\([;{}]\\|\\b\\(if\\|for\\|while\\)\\b\\)"
                           (thing-at-point 'line)))))
#+end_example

#+begin_src emacs-lisp
  (global-aggressive-indent-mode 1)
#+end_src

** Swiper
#+BEGIN_SRC emacs-lisp
  (use-package swiper
    :ensure t
    :config
    (progn
      (ivy-mode 1)
      (setq ivy-use-virtual-buffers t)
      (global-set-key "\C-s" 'swiper-isearch)
      (global-set-key "\M-S" 'counsel-org-goto)
      (global-set-key (kbd "C-c g") 'counsel-git)
      (global-set-key (kbd "M-x") 'counsel-M-x)
      (global-set-key (kbd "C-x C-f") 'counsel-find-file)
      (global-set-key (kbd "<f1> f") 'counsel-describe-function)
      (global-set-key (kbd "<f1> v") 'counsel-describe-variable)
      (global-set-key (kbd "<f1> l") 'counsel-load-library)
      (global-set-key (kbd "<f2> i") 'counsel-info-lookup-symbol)
      (global-set-key (kbd "<f2> u") 'counsel-unicode-char)
      (global-set-key (kbd "C-c j") 'counsel-git-grep)
      (global-set-key (kbd "<f6>") 'ivy-resume)
      (global-set-key (kbd "C-c i") 'counsel-imenu)
      (global-set-key (kbd "C-x l") 'counsel-locate)
      (global-set-key (kbd "C-x C-r") 'counsel-recentf)
      (define-key read-expression-map (kbd "C-r") 'counsel-expression-history)
      ))
#+END_SRC

* ORG
  :PROPERTIES:
  :header-args: :tangle ~/.config/emacs/modules/ORG.el
  :header-args: :results none
  :END:
** GLOBAL
#+begin_src elisp
 (add-hook 'org-mode-hook 'org-indent-mode)
#+end_src
** GTD
*** Global
   #+begin_src emacs-lisp
     ;; ;; Adding a separator line between days in Emacs Org-mode calender view (prettier)

     ;;     (setq org-agenda-format-date (lambda (date) (concat "\n"
     ;;                                                         (make-string (window-width) 9472)
     ;;                                                         "\n"
     ;;                                                         (org-agenda-format-date-aligned date))))
     (setq org-agenda-directory "~/org/gtd/"
           org-agenda-files '("~/org/gtd" ))                    ;; org-agenda-files

     (setq org-agenda-dim-blocked-tasks nil                    ;; Do not dim blocked tasks
           org-agenda-span 'day                                ;; show me one day
           org-agenda-inhibit-startup t                        ;; Stop preparing agenda buffers on startup:
           org-agenda-use-tag-inheritance nil                  ;; Disable tag inheritance for agendas:
           org-agenda-show-log t
           org-agenda-skip-scheduled-if-done t
           org-agenda-skip-deadline-if-done t
           org-agenda-skip-deadline-prewarning-if-scheduled 'pre-scheduled
           org-agenda-deadline-leaders '("!D!: " "D%2d: " "")
           org-agenda-scheduled-leaders '("" "S%3d: ")

           org-agenda-time-grid
           '((daily today require-timed)
             (800 1000 1200 1400 1600 1800 2000)
             "......" "----------------"))
     (setq
      org-agenda-start-on-weekday 0                          ;; Weekday start on Sunday
      org-treat-S-cursor-todo-selection-as-state-change nil ;; S-R,S-L skip the note/log info[used when fixing the state]
      org-agenda-tags-column -130                          ;; Set tags far to the right
      org-clock-out-remove-zero-time-clocks t              ;; Sometimes I change tasks I'm clocking quickly - this removes clocked tasks with 0:00 duration
      org-clock-persist t                                  ;; Save the running clock and all clock history when exiting Emacs, load it on startup
      org-use-fast-todo-selection t                        ;; from any todo state to any other state; using it keys
      org-agenda-window-setup 'only-window)                 ;; Always open my agenda in fullscreen

     (setq org-agenda-prefix-format
           '((agenda . " %i %-12:c%?-12t %s")
             (todo   . " ")
             (tags   . " %i %-12:c")
             (search . " %i %-12:c")))
     ;; define org's states
     (setq org-todo-keywords
           '((sequence "TODO(t)" "NEXT(n)" "|" "DONE(d)")
             (sequence "WAITING(w@/!)" "HOLD(h@/!)" "|" "CANCELLED(c@/!)")))

     ;;Thanks to Erik Anderson, we can also add a hook that will log when we activate
     ;;a task by creating an “ACTIVATED” property the first time the task enters the NEXT state:
     (defun log-todo-next-creation-date (&rest ignore)
       "Log NEXT creation time in the property drawer under the key 'ACTIVATED'"
       (when (and (string= (org-get-todo-state) "NEXT")
                  (not (org-entry-get nil "ACTIVATED")))
         (org-entry-put nil "ACTIVATED" (format-time-string "[%Y-%m-%d]"))))

     (add-hook 'org-after-todo-state-change-hook #'log-todo-next-creation-date)
     (add-hook 'org-agenda-mode-hook                            ;; disable line-number when i open org-agenda view
                (lambda() (display-line-numbers-mode -1)))

     ;; (define-key global-map (kbd "C-c c") 'org-capture)
     ;; (define-key global-map (kbd "C-c a") 'org-agenda)
  #+end_src

*** ORG AGENDA
    #+begin_src emacs-lisp
      (setq org-agenda-block-separator  9472)                  ;; use 'straight line' as a block-agenda divider
      (setq org-agenda-custom-commands
            '(("g" "Get Things Done (GTD)"
               ((agenda ""
                        ((org-agenda-span 'day)
                         (org-deadline-warning-days 365)))
                (todo "TODO"
                      ((org-agenda-overriding-header "inbox")
                       (org-agenda-files '("~/org/gtd/inbox.org"))))

                (todo "TODO"
                      ((org-agenda-overriding-header "Emails")
                       (org-agenda-files '("~/org/gtd/emails.org"))))

                (todo "NEXT"
                      ((org-agenda-overriding-header "In Progress")
                       (org-agenda-prefix-format "  %i %-12:c [%e] ")
                       (org-agenda-files '("~/org/gtd/someday.org"
                                           "~/org/gtd/projects.org"
                                           "~/org/gtd/next.org"))
                       ))
                (todo "TODO"
                      ((org-agenda-overriding-header "Projects")
                       (org-agenda-files '("~/org/gtd/projects.org")))
                      )

                (todo "TODO"
                      ((org-agenda-overriding-header "One-off Tasks")
                       (org-agenda-files '("~/org/gtd/next.org"))
                       (org-agenda-skip-function '(org-agenda-skip-entry-if
                                                   'deadline 'scheduled))))
                nil))))

    #+end_src
*** Habit
    #+BEGIN_SRC emacs-lisp
      (require 'org-habit)
      (add-to-list 'org-modules 'org-habit)
      (setq org-habit-graph-column 48)
      (setq org-habit-show-habits-only-for-today t)
    #+END_SRC

*** Refiling
    #+begin_src emacs-lisp
      ;; Refiling [need reading]
      ;;tell org-mode we want to specify a refile target using the file path.
      (setq org-refile-use-outline-path 'file
       org-outline-path-complete-in-steps nil)
      (setq org-refile-allow-creating-parent-nodes 'confirm)
      (setq org-refile-targets '(("~/org/gtd/next.org" :level . 0)
                                 ("~/org/ideas.org" :level . 1)
                                 ("~/org/links.org" :level . 1)
                                 ("~/org/gtd/someday.org" :regexp . "\\(?:\\(?:Task\\|idea\\|p\\(?:\\(?:os\\|rojec\\)t\\)\\)s\\)")
                                 ("projects.org" :regexp . "\\(?:Tasks\\)"))) 
      ;;("someday.org" :level . 0)
    #+end_src
** org capture
   #+begin_src emacs-lisp
     (setq org-capture-templates
           `(("i" "Inbox" entry  (file "~/org/gtd/inbox.org")
              ,(concat "* TODO %?\n"
                       "/Entered on/ %U"))
             ("l" "Link" entry (file+headline "~/org/gtd/inbox.org" "Links")
              ,(concat "* TODO %a %?\n"
                       "/Entered on/ %U") :immediate-finish t)
             ))
   #+end_src

** org protocol
#+begin_src emacs-lisp
(require 'org-protocol)
#+end_src

** Other Functions
   #+BEGIN_SRC emacs-lisp
     (defun zk/switch-to-agenda ()
          (interactive)
          (org-agenda nil "g"))
     ;; PS: check out the original code from here:
     ;; https://github.com/gjstein/emacs.d/blob/master/config/gs-org.el

     ;;clocking-out changes NEXT to HOLD
     ;;clocking-in changes HOLD to NEXT
     (setq org-clock-in-switch-to-state 'zk/clock-in-to-next)
     (setq org-clock-out-switch-to-state 'zk/clock-out-to-hold)
     (defun zk/clock-in-to-next (kw)
       "Switch a task from TODO to NEXT when clocking in.
        Skips capture tasks, projects, and subprojects.
        Switch projects and subprojects from NEXT back to TODO"
       (when (not (and (boundp 'org-capture-mode) org-capture-mode))
         (cond
          ((and (member (org-get-todo-state) (list "TODO")))
           "NEXT")
          ((and (member (org-get-todo-state) (list "HOLD")))
           "NEXT")
           )))
     (defun zk/clock-out-to-hold (kw)
       (when (not (and (boundp 'org-capture-mode) org-capture-mode))
         (cond
          ((and (member (org-get-todo-state) (list "NEXT")))  "HOLD")
           )))

   #+END_SRC

** todo faces
   #+begin_src emacs-lisp
    (setq org-todo-keywords
      '((sequence "TODO(t)" "NEXT(n)" "HOLD(h)" "|" "DONE(d)" "CANCELED")))
    (setq org-todo-keyword-faces
      '(
        ("TODO" . (:foreground "brown2" :weight bold))
        ("READ" . (:foreground "brown2" :weight bold))

        ("NEXT" . (:foreground "#00b0d1"  :weight bold ))
        ("READING" . (:foreground "#00b0d1"  :weight bold ))

        ("DONE" . (:foreground "#16a637" :weight bold))

        ("HOLD" . (:foreground "orange"  :weight bold))

        ("CANCELED" . (:foreground "gray" :background "red1" :weight bold))
      ))
   #+end_src

** COMMENT org-exports
*** Latex
 #+begin_src emacs-lisp
   (add-to-list 'org-latex-classes
                    '("elsarticle"
                      "\\documentclass{elsarticle}
    [NO-DEFAULT-PACKAGES]
    [PACKAGES]
    [EXTRA]"
                      ("\\section{%s}" . "\\section*{%s}")
                      ("\\subsection{%s}" . "\\subsection*{%s}")
                      ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
                      ("\\paragraph{%s}" . "\\paragraph*{%s}")
                      ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
   (add-to-list 'org-latex-classes
                    '("mimosis"
                      "\\documentclass{mimosis}
    [NO-DEFAULT-PACKAGES]
    [PACKAGES]
    [EXTRA]
   \\newcommand{\\mboxparagraph}[1]{\\paragraph{#1}\\mbox{}\\\\}
   \\newcommand{\\mboxsubparagraph}[1]{\\subparagraph{#1}\\mbox{}\\\\}"
                      ("\\chapter{%s}" . "\\chapter*{%s}")
                      ("\\section{%s}" . "\\section*{%s}")
                      ("\\subsection{%s}" . "\\subsection*{%s}")
                      ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
                      ("\\mboxparagraph{%s}" . "\\mboxparagraph*{%s}")
                      ("\\mboxsubparagraph{%s}" . "\\mboxsubparagraph*{%s}")))

   (add-to-list 'org-latex-classes
                '( "koma-article"
                   "\\documentclass{scrartcl}"
                   ( "\\section{%s}" . "\\section*{%s}" )
                   ( "\\subsection{%s}" . "\\subsection*{%s}" )
                   ( "\\subsubsection{%s}" . "\\subsubsection*{%s}" )
                   ( "\\paragraph{%s}" . "\\paragraph*{%s}" )
                   ( "\\subparagraph{%s}" . "\\subparagraph*{%s}" )))
   ;; Coloured LaTeX using Minted
   (setq org-latex-listings 'minted
       org-latex-packages-alist '(("" "minted"))
       org-latex-pdf-process
       '("xelatex -shell-escape -interaction nonstopmode -output-directory %o %f"
         "biber %b"
         "xelatex -shell-escape -interaction nonstopmode -output-directory %o %f"
         "xelatex -shell-escape -interaction nonstopmode -output-directory %o %f"))

   ;; syntex-highlighting
   (use-package htmlize)
   ;;Don’t include a footer...etc in exported HTML document.
   (setq org-html-postamble nil)
   (setq org-src-window-setup 'current-window)

   (add-hook 'org-babel-after-execute-hook 'org-display-inline-images)
   (add-hook 'org-mode-hook 'org-display-inline-images)
 #+end_src
** Reveal-js
   #+begin_src emacs-lisp
     (use-package ox-reveal
       :ensure ox-reveal)
     (setq org-reveal-root
           "file:///home/zakaria/org/files/conf/revealJS/reveal.js-4.1.0")
     (setq org-reveal-mathjax t)
   #+end_src

** Babel
   #+BEGIN_SRC emacs-lisp
     (eval-after-load "org"
       (use-package ob-async
         :ensure t
         :init (require 'ob-async)))
     (setq org-confirm-babel-evaluate nil
           org-src-fontify-natively t
           org-confirm-babel-evaluate nil
           org-src-tab-acts-natively t)
     (org-babel-do-load-languages
      'org-babel-load-languages
      '((python . t)
        (shell . t)
        (emacs-lisp . t)
        (R . t)
        ))
   #+END_SRC

